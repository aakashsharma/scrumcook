<% if @pre_category and !(@pre_category.eql? @workable_item.category) %>
$('#<%= @workable_item.id %>_item_box').remove();
$('#<%= @workable_item.category %>_item_list_end').before('<%=escape_javascript render :partial => 'workable_items/workable_item', :locals => {:workable_item => @workable_item} %>');
$('#<%= @workable_item.category %>').show();
<% else %>
if (view == "sprint") {
    $('#<%= @workable_item.id %>_item_box').remove();
    <%
    item_list = "dev_ready"
    if @workable_item.started?
    item_list = "in_progress"
    elsif @workable_item.finished?
     item_list = "dev_done"
    elsif @workable_item.delivered?
       item_list = "qa_ready"
    elsif @workable_item.accepted? or @workable_item.rejected?
       item_list = "qa_done"
    end %>
    $('#<%= item_list %>_item_list_end').before('<%=escape_javascript render :partial => 'workable_items/workable_item', :locals => {:workable_item => @workable_item} %>');
    $('#<%= item_list %>').show();
} else {
    $('#<%= @workable_item.id %>_preview_box').html('<%=escape_javascript render :partial => 'workable_items/workable_item_preview', :locals => {:workable_item => @workable_item} %>');
    $('#<%= @workable_item.id %>_detail_box').html('<%=escape_javascript render :partial => 'workable_items/workable_item_detail', :locals => {:workable_item => @workable_item} %>');
}
<% end %>
attachTokenInput($('#<%= @workable_item.id %>_labels'));
<% if @message.present?%>
ajax_flash_notice('<%="#{@message}"%>');
<%else%>
ajax_flash_notice('<%="#{@workable_item.type} was #{@workable_item.status}."%>');
<%end%>
highlight_item($('#<%= @workable_item.id %>_content'));